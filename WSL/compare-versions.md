---
title: Обзор подсистемы Windows для Linux
description: Сведения о подсистеме Windows для Linux, различных версиях и способах их использования.
keywords: BashOnWindows, bash, wsl, windows, windowssubsystem, gnu, linux, ubuntu, debian, suse, windows 10, изменения взаимодействия с пользователем, WSL 2, ядро linux, сетевые приложения, localhost, IPv6, виртуальный жесткий диск, VHD, ограничения VHD, ошибка VHD
ms.date: 05/12/2020
ms.topic: article
ms.localizationpriority: high
ms.openlocfilehash: bbd5b36f7857d136d3eb2f75eb3d1a36ac2b94f7
ms.sourcegitcommit: eaceda3589b9bd777e0fead5ef33bb16060a55d2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/18/2020
ms.locfileid: "84978267"
---
# <a name="comparing-wsl-2-and-wsl-1"></a><span data-ttu-id="ee392-104">Сравнение WSL 2 и WSL 1</span><span class="sxs-lookup"><span data-stu-id="ee392-104">Comparing WSL 2 and WSL 1</span></span>

<span data-ttu-id="ee392-105">Основной целью обновления подсистемы Windows для Linux до новой версии является **повышение производительности файловой системы** и поддержка **полной совместимости системных вызовов**.</span><span class="sxs-lookup"><span data-stu-id="ee392-105">The primary goals of updating the Windows Subsystem for Linux to a new version are to **increase file system performance** and support **full system call compatibility**.</span></span> 

<span data-ttu-id="ee392-106">WSL 2 использует последнюю и самую новую технологию виртуализации для запуска ядра Linux внутри упрощенной служебной виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="ee392-106">WSL 2 uses the latest and greatest in virtualization technology to run a Linux kernel inside of a lightweight utility virtual machine (VM).</span></span> <span data-ttu-id="ee392-107">Однако WSL 2 не является традиционным функционалом виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="ee392-107">However, WSL 2 is not a traditional VM experience.</span></span> <span data-ttu-id="ee392-108">[Дополнительные сведения об архитектуре WSL 2](#wsl-2-architecture).</span><span class="sxs-lookup"><span data-stu-id="ee392-108">[Learn more about the WSL 2 architecture](#wsl-2-architecture).</span></span>

## <a name="comparing-features"></a><span data-ttu-id="ee392-109">Сравнение возможностей</span><span class="sxs-lookup"><span data-stu-id="ee392-109">Comparing features</span></span>

<span data-ttu-id="ee392-110">Функция</span><span class="sxs-lookup"><span data-stu-id="ee392-110">Feature</span></span> | <span data-ttu-id="ee392-111">WSL 1</span><span class="sxs-lookup"><span data-stu-id="ee392-111">WSL 1</span></span> | <span data-ttu-id="ee392-112">WSL 2</span><span class="sxs-lookup"><span data-stu-id="ee392-112">WSL 2</span></span>
--- | --- | ---
 <span data-ttu-id="ee392-113">Интеграция Windows и Linux</span><span class="sxs-lookup"><span data-stu-id="ee392-113">Integration between Windows and Linux</span></span>| ✅|✅
 <span data-ttu-id="ee392-114">Быстрый запуск</span><span class="sxs-lookup"><span data-stu-id="ee392-114">Fast boot times</span></span>| ✅ | ✅
 <span data-ttu-id="ee392-115">Незначительный расход ресурсов</span><span class="sxs-lookup"><span data-stu-id="ee392-115">Small resource foot print</span></span>| ✅ |✅
 <span data-ttu-id="ee392-116">Управляемая виртуальная машина</span><span class="sxs-lookup"><span data-stu-id="ee392-116">Managed VM</span></span>| ❌ | ✅
 <span data-ttu-id="ee392-117">Полнофункциональное ядро Linux</span><span class="sxs-lookup"><span data-stu-id="ee392-117">Full Linux Kernel</span></span>| ❌ |✅
 <span data-ttu-id="ee392-118">Полная совместимость системных вызовов</span><span class="sxs-lookup"><span data-stu-id="ee392-118">Full system call compatibility</span></span>| ❌ | ✅
 <span data-ttu-id="ee392-119">Запуск с использованием текущих версий VMWare и VirtualBox</span><span class="sxs-lookup"><span data-stu-id="ee392-119">Runs with current versions of VMWare and VirtualBox</span></span>| ✅ | ❌
 <span data-ttu-id="ee392-120">Производительность в файловых системах ОС</span><span class="sxs-lookup"><span data-stu-id="ee392-120">Performance across OS file systems</span></span>| ✅ | ❌

<span data-ttu-id="ee392-121">Уже используете WSL 1 и хотите выполнить обновление до WSL 2?</span><span class="sxs-lookup"><span data-stu-id="ee392-121">Already using WSL 1 and want to upgrade to WSL 2?</span></span> <span data-ttu-id="ee392-122">Следуйте инструкциям, чтобы выполнить [обновление до WSL 2](./install-win10.md#update-to-wsl-2)!</span><span class="sxs-lookup"><span data-stu-id="ee392-122">Follow the instructions to [update to WSL 2](./install-win10.md#update-to-wsl-2)!</span></span>

<span data-ttu-id="ee392-123">Подсистема WSL 2 доступна только в Windows 10 версии 2004, сборки 19041 или выше.</span><span class="sxs-lookup"><span data-stu-id="ee392-123">WSL 2 is only available in Windows 10, Version 2004, Build 19041 or higher.</span></span> <span data-ttu-id="ee392-124">Проверьте версию Windows, нажав **Windows + R**, введите **winver**, выберите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="ee392-124">Check your Windows version by selecting the **Windows logo key + R**, type **winver**, select **OK**.</span></span> <span data-ttu-id="ee392-125">(Или введите команду `ver` в командной строке Windows).</span><span class="sxs-lookup"><span data-stu-id="ee392-125">(Or enter the `ver` command in Windows Command Prompt).</span></span> <span data-ttu-id="ee392-126">Может потребоваться [выполнить обновление до последней версии Windows](ms-settings:windowsupdate).</span><span class="sxs-lookup"><span data-stu-id="ee392-126">You may need to [update to the latest Windows version](ms-settings:windowsupdate).</span></span> <span data-ttu-id="ee392-127">Для сборок ниже 19041 WSL не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="ee392-127">For builds lower than 19041, WSL is not supported at all.</span></span>

> [!NOTE]
> <span data-ttu-id="ee392-128">WSL 2 будет работать с [предварительными версиями VMWare](https://blogs.vmware.com/workstation/2020/01/vmware-workstation-tech-preview-20h1.html) и [VirtualBox 6.x](https://www.virtualbox.org/wiki/Changelog-6.0).</span><span class="sxs-lookup"><span data-stu-id="ee392-128">WSL 2 will work with [preview versions of VMWare](https://blogs.vmware.com/workstation/2020/01/vmware-workstation-tech-preview-20h1.html) and [VirtualBox 6.x](https://www.virtualbox.org/wiki/Changelog-6.0).</span></span>

## <a name="use-the-linux-file-system-for-faster-performance"></a><span data-ttu-id="ee392-129">Использование файловой системы Linux для повышения производительности</span><span class="sxs-lookup"><span data-stu-id="ee392-129">Use the Linux file system for faster performance</span></span>

<span data-ttu-id="ee392-130">Чтобы оптимизировать производительность, убедитесь, что файлы проекта хранятся в файловой системе Linux (а не в файловой системе Windows).</span><span class="sxs-lookup"><span data-stu-id="ee392-130">In order to optimize for the fastest performance speed, be sure to store your project files in the Linux file system (not the Windows file system).</span></span>

<span data-ttu-id="ee392-131">Например, при хранении файлов проекта WSL:</span><span class="sxs-lookup"><span data-stu-id="ee392-131">For example, when storing your WSL project files:</span></span>

* <span data-ttu-id="ee392-132">Используйте корневой каталог файловой системы Linux: `\\wsl$\Ubuntu-18.04\home\<user name>\Project`</span><span class="sxs-lookup"><span data-stu-id="ee392-132">Use the Linux file system root directory: `\\wsl$\Ubuntu-18.04\home\<user name>\Project`</span></span>
* <span data-ttu-id="ee392-133">Не является корневым каталогом файловой системы Windows: `C:\Users\<user name>\Project`</span><span class="sxs-lookup"><span data-stu-id="ee392-133">Not the Windows file system root directory: `C:\Users\<user name>\Project`</span></span>

<span data-ttu-id="ee392-134">Чтобы иметь возможность воспользоваться преимуществами более быстрого доступа к файловой системе, файлы проекта, с которыми вы работаете с помощью дистрибутива WSL (например, Ubuntu), должны находиться в корневой файловой системе Linux.</span><span class="sxs-lookup"><span data-stu-id="ee392-134">Project files that you are working with using a WSL distribution (like Ubuntu) must be in the Linux root file system to take advantage of faster file system access.</span></span>

<span data-ttu-id="ee392-135">Доступ к корневой файловой системе Linux можно получить с помощью приложений и средств Windows, таких как проводник.</span><span class="sxs-lookup"><span data-stu-id="ee392-135">You can access your Linux root file system with Windows apps and tools like File Explorer.</span></span> <span data-ttu-id="ee392-136">Попробуйте открыть дистрибутив Linux (например, Ubuntu), убедитесь, что находитесь в домашнем каталоге Linux, введя следующую команду: `cd ~`.</span><span class="sxs-lookup"><span data-stu-id="ee392-136">Try opening a Linux distribution (like Ubuntu), be sure that you are in the Linux home directory by entering this command: `cd ~`.</span></span> <span data-ttu-id="ee392-137">Затем откройте файловую систему Linux в проводнике, введя *(не забудьте точку в конце)* : `explorer.exe .`</span><span class="sxs-lookup"><span data-stu-id="ee392-137">Then open your Linux file system in File Explorer by entering *(don't forget the period at the end)*: `explorer.exe .`</span></span>

## <a name="exceptions-for-using-wsl-1-rather-than-wsl-2"></a><span data-ttu-id="ee392-138">Исключения для использования WSL 1 вместо WSL 2</span><span class="sxs-lookup"><span data-stu-id="ee392-138">Exceptions for using WSL 1 rather than WSL 2</span></span>

<span data-ttu-id="ee392-139">Рекомендуется использовать WSL 2, так как он обеспечивает более высокую производительность и полную совместимость системных вызовов.</span><span class="sxs-lookup"><span data-stu-id="ee392-139">We recommend that you use WSL 2 as it offers faster performance and 100% system call compatibility.</span></span> <span data-ttu-id="ee392-140">Однако существует несколько отдельных сценариев, в которых использовать WSL 1 может оказаться более предпочтительным.</span><span class="sxs-lookup"><span data-stu-id="ee392-140">However, there are a few specific scenarios where you might prefer using WSL 1.</span></span> <span data-ttu-id="ee392-141">Рекомендуем использовать WSL 1, если:</span><span class="sxs-lookup"><span data-stu-id="ee392-141">Consider using WSL 1 if:</span></span>

* <span data-ttu-id="ee392-142">Файлы проекта должны храниться в файловой системе Windows.</span><span class="sxs-lookup"><span data-stu-id="ee392-142">Your project files must be stored in the Windows file system.</span></span>
  * <span data-ttu-id="ee392-143">Если вы будете использовать дистрибутив Linux WSL для доступа к файлам проекта в файловой системе Windows, и эти файлы не могут храниться в файловой системе Linux, вы получите более высокую производительность в файловых системах ОС, используя WSL 1.</span><span class="sxs-lookup"><span data-stu-id="ee392-143">If you will be using your WSL Linux distribution to access project files on the Windows file system, and these files cannot be stored on the Linux file system, you will achieve faster performance across the OS files systems by using WSL 1.</span></span>
* <span data-ttu-id="ee392-144">Проект, для которого требуется перекрестная компиляция с использованием средств Windows и Linux на одних и тех же файлах.</span><span class="sxs-lookup"><span data-stu-id="ee392-144">A project which requires cross-compilation using both Windows and Linux tools on the same files.</span></span>
  * <span data-ttu-id="ee392-145">Операции с файлами в операционных системах Windows и Linux выполняются быстрее в WSL 1, чем на WSL 2. Поэтому если вы используете приложения Windows для доступа к файлам Linux, в настоящее время вы получите более высокую производительность при использовании WSL 1.</span><span class="sxs-lookup"><span data-stu-id="ee392-145">File performance across the Windows and Linux operating systems is faster in WSL 1 than WSL 2, so if you are using Windows applications to access Linux files, you will currently achieve faster performance with WSL 1.</span></span>

> [!NOTE]
> <span data-ttu-id="ee392-146">Попробуйте использовать [удаленное расширение WSL](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl) VS Code, чтобы хранить файлы проекта в файловой системе Linux, используя средства командной строки Linux. Также с помощью VS Code в Windows можно создавать, редактировать, отлаживать или запускать проекты в браузере без снижения производительности, связанной с работой в файловых системах Linux и Windows.</span><span class="sxs-lookup"><span data-stu-id="ee392-146">Consider trying the VS Code [Remote WSL Extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl) to enable you to store your project files on the Linux file system, using Linux command line tools, but also using VS Code on Windows to author, edit, debug, or run your project in an internet browser without any of the performance slow-downs associated with working across the Linux and Windows file systems.</span></span> <span data-ttu-id="ee392-147">[Подробнее.](https://code.visualstudio.com/docs/remote/wsl)</span><span class="sxs-lookup"><span data-stu-id="ee392-147">[Learn more](https://code.visualstudio.com/docs/remote/wsl).</span></span>

## <a name="wsl-2-architecture"></a><span data-ttu-id="ee392-148">Архитектура WSL 2</span><span class="sxs-lookup"><span data-stu-id="ee392-148">WSL 2 architecture</span></span>

<span data-ttu-id="ee392-149">Во время обычной работы виртуальная машина может замедляться при загрузке, изолироваться, потреблять много ресурсов и требовать время для управления.</span><span class="sxs-lookup"><span data-stu-id="ee392-149">A traditional VM experience can be slow to boot up, is isolated, consumes lots of resources, and requires your time to manage it.</span></span> <span data-ttu-id="ee392-150">В подсистеме WSL 2 нет таких проблем.</span><span class="sxs-lookup"><span data-stu-id="ee392-150">WSL 2 does not have these attributes.</span></span>

<span data-ttu-id="ee392-151">WSL 2 предоставляет преимущества WSL 1, включая простую интеграцию между Windows и Linux, быструю загрузку, незначительное потребление ресурсов и не требует настройки виртуальной машины или управления ею.</span><span class="sxs-lookup"><span data-stu-id="ee392-151">WSL 2 provides the benefits of WSL 1, including seamless integration between Windows and Linux, fast boot times, a small resource footprint, and requires no VM configuration or management.</span></span> <span data-ttu-id="ee392-152">Хотя WSL 2 использует виртуальную машину, она будет управляемой и будет работать в фоновом режиме, предоставляя тот же пользовательский интерфейс, что и WSL 1.</span><span class="sxs-lookup"><span data-stu-id="ee392-152">While WSL 2 does use a VM, it is managed and run behind the scenes, leaving you with the same user experience as WSL 1.</span></span>

### <a name="full-linux-kernel"></a><span data-ttu-id="ee392-153">Полнофункциональное ядро Linux</span><span class="sxs-lookup"><span data-stu-id="ee392-153">Full Linux kernel</span></span>

<span data-ttu-id="ee392-154">Ядро Linux в WSL 2 собрано собственными силами корпорации Майкрософт на основе последней стабильной ветви исходного кода, доступного по адресу kernel.org. Этот ядро специально настроено для WSL 2 путем оптимизации размера и производительности, чтобы обеспечить невероятное взаимодействие с Linux в Windows.</span><span class="sxs-lookup"><span data-stu-id="ee392-154">The Linux kernel in WSL 2 is built by Microsoft from the latest stable branch, based on the source available at kernel.org. This kernel has been specially tuned for WSL 2, optimizing for size and performance to provide an amazing Linux experience on Windows.</span></span> <span data-ttu-id="ee392-155">Ядро будет обслуживаться обновлениями Windows. Это означает, что вы получите новейшие исправления безопасности и улучшения ядра без необходимости заниматься этим самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="ee392-155">The kernel will be serviced by Windows updates, which means you will get the latest security fixes and kernel improvements without needing to manage it yourself.</span></span>

<span data-ttu-id="ee392-156">[Ядро Linux WSL 2 — это проект с открытым исходным кодом](https://github.com/microsoft/WSL2-Linux-Kernel).</span><span class="sxs-lookup"><span data-stu-id="ee392-156">The [WSL 2 Linux kernel is open source](https://github.com/microsoft/WSL2-Linux-Kernel).</span></span> <span data-ttu-id="ee392-157">Если вы хотите узнать больше, ознакомьтесь с записью блога [Реализация ядра Linux в Windows](https://devblogs.microsoft.com/commandline/shipping-a-linux-kernel-with-windows/), созданной группой, которая занималась сборкой ядра.</span><span class="sxs-lookup"><span data-stu-id="ee392-157">If you'd like to learn more, check out the blog post [Shipping a Linux Kernel with Windows](https://devblogs.microsoft.com/commandline/shipping-a-linux-kernel-with-windows/) written by the team that built it.</span></span>

### <a name="increased-file-io-performance"></a><span data-ttu-id="ee392-158">Повышенная производительность операций ввода-вывода файлов</span><span class="sxs-lookup"><span data-stu-id="ee392-158">Increased file IO performance</span></span>

<span data-ttu-id="ee392-159">Команды для операций с большими объемами файлов, такие как git clone, npm install, apt update, apt upgrade и многое другое, выполняются заметно быстрее с WSL 2.</span><span class="sxs-lookup"><span data-stu-id="ee392-159">File intensive operations like git clone, npm install, apt update, apt upgrade, and more are all be noticeably faster with WSL 2.</span></span>

<span data-ttu-id="ee392-160">Фактическое увеличение скорости будет зависеть от того, какое приложение вы используете и как оно взаимодействует с файловой системой.</span><span class="sxs-lookup"><span data-stu-id="ee392-160">The actual speed increase will depend on which app you're running and how it is interacting with the file system.</span></span> <span data-ttu-id="ee392-161">Первоначальные версии WSL 2 запускаются в 20 раз быстрее по сравнению с WSL 1 при распаковке сжатого архива tarball и в 2–5 раз быстрее при использовании команд git clone, npm install и cmake в различных проектах.</span><span class="sxs-lookup"><span data-stu-id="ee392-161">Initial versions of WSL 2 run up to 20x faster compared to WSL 1 when unpacking a zipped tarball, and around 2-5x faster when using git clone, npm install and cmake on various projects.</span></span>

### <a name="full-system-call-compatibility"></a><span data-ttu-id="ee392-162">Полная совместимость системных вызовов</span><span class="sxs-lookup"><span data-stu-id="ee392-162">Full system call compatibility</span></span>

<span data-ttu-id="ee392-163">Двоичные файлы Linux используют системные вызовы для выполнения функций, таких как доступ к файлам, запрос памяти, создание процессов и многое другое.</span><span class="sxs-lookup"><span data-stu-id="ee392-163">Linux binaries use system calls to perform functions such as accessing files, requesting memory, creating processes, and more.</span></span> <span data-ttu-id="ee392-164">В то время как WSL 1 использует уровень перевода, созданный командой WSL, WSL 2 имеет собственное ядро Linux с полной совместимостью системных вызовов.</span><span class="sxs-lookup"><span data-stu-id="ee392-164">Whereas WSL 1 used a translation layer that was built by the WSL team, WSL 2 includes its own Linux kernel with full system call compatibility.</span></span> <span data-ttu-id="ee392-165">Доступные преимущества:</span><span class="sxs-lookup"><span data-stu-id="ee392-165">Benefits include:</span></span>

* <span data-ttu-id="ee392-166">целый ряд новых приложений, которые можно запускать внутри WSL, например **[Docker](https://code.visualstudio.com/blogs/2020/03/02/docker-in-wsl2)** и другие;</span><span class="sxs-lookup"><span data-stu-id="ee392-166">A whole new set of apps that you can run inside of WSL, such as **[Docker](https://code.visualstudio.com/blogs/2020/03/02/docker-in-wsl2)** and more.</span></span>

* <span data-ttu-id="ee392-167">все обновления ядра Linux немедленно готовы к использованию.</span><span class="sxs-lookup"><span data-stu-id="ee392-167">Any updates to the Linux kernel are immediately ready for use.</span></span> <span data-ttu-id="ee392-168">(Вам не нужно ждать, пока специалисты WSL реализуют обновления и добавят изменения).</span><span class="sxs-lookup"><span data-stu-id="ee392-168">(You don't have to wait for the WSL team to implement updates and add the changes).</span></span>

### <a name="wsl-2-uses-a-smaller-amount-of-memory-on-startup"></a><span data-ttu-id="ee392-169">WSL 2 использует меньший объем памяти при запуске</span><span class="sxs-lookup"><span data-stu-id="ee392-169">WSL 2 uses a smaller amount of memory on startup</span></span>

<span data-ttu-id="ee392-170">WSL 2 использует упрощенную служебную виртуальную машину на реальном ядре Linux с небольшим потреблением памяти.</span><span class="sxs-lookup"><span data-stu-id="ee392-170">WSL 2 uses a lightweight utility VM on a real Linux kernel with a small memory footprint.</span></span> <span data-ttu-id="ee392-171">Эта программа будет выделять память с виртуальным адресом при запуске.</span><span class="sxs-lookup"><span data-stu-id="ee392-171">The utility will allocate Virtual Address backed memory on startup.</span></span> <span data-ttu-id="ee392-172">Она настроена на запуск с использованием незначительной доли общей памяти, которая требовалось для WSL 1.</span><span class="sxs-lookup"><span data-stu-id="ee392-172">It is configured to start with a smaller proportion of your total memory that what was required for WSL 1.</span></span>

## <a name="accessing-network-applications"></a><span data-ttu-id="ee392-173">Доступ к сетевым приложениям</span><span class="sxs-lookup"><span data-stu-id="ee392-173">Accessing network applications</span></span>

### <a name="accessing-linux-networking-apps-from-windows-localhost"></a><span data-ttu-id="ee392-174">Доступ к сетевым приложениям Linux из Windows (localhost)</span><span class="sxs-lookup"><span data-stu-id="ee392-174">Accessing Linux networking apps from Windows (localhost)</span></span>

<span data-ttu-id="ee392-175">Если вы создаете сетевое приложение (например, приложение, работающее на NodeJS или SQL Server) в дистрибутиве Linux, вы можете получить к нему доступ из приложения Windows (например, используя Edge или Chrome) с помощью `localhost` (как обычно это и происходит).</span><span class="sxs-lookup"><span data-stu-id="ee392-175">If you are building a networking app (for example an app running on a NodeJS or SQL server) in your Linux distribution, you can access it from a Windows app (like your Edge or Chrome internet browser) using `localhost` (just like you normally would).</span></span>

<span data-ttu-id="ee392-176">Тем не менее, если вы используете более раннюю версию Windows (сборка 18945 или меньше), вам потребуется получить IP-адрес виртуальной машины узла Linux (или [обновить ее до последней версии Windows](ms-settings:windowsupdate)).</span><span class="sxs-lookup"><span data-stu-id="ee392-176">However, if you are running an older version of Windows (Build 18945 or less), you will need to get the IP address of the Linux host VM (or [update to the latest Windows version](ms-settings:windowsupdate)).</span></span>

<span data-ttu-id="ee392-177">Чтобы найти IP-адрес виртуальной машины, содержащей дистрибутив Linux, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="ee392-177">To find the IP address of the virtual machine powering your Linux distribution:</span></span>

* <span data-ttu-id="ee392-178">В дистрибутиве WSL (напр., Ubuntu) выполните команду: `ip addr`</span><span class="sxs-lookup"><span data-stu-id="ee392-178">From your WSL distribution (ie Ubuntu), run the command: `ip addr`</span></span>
* <span data-ttu-id="ee392-179">Найдите и скопируйте адрес в значение `inet` интерфейса `eth0`.</span><span class="sxs-lookup"><span data-stu-id="ee392-179">Find and copy the address under the `inet` value of the `eth0` interface.</span></span>
* <span data-ttu-id="ee392-180">Если у вас установлено средство grep, найдите его с помощью команды: `ip addr | grep eth0`</span><span class="sxs-lookup"><span data-stu-id="ee392-180">If you have the grep tool installed, find this more easily by filtering the output with the command: `ip addr | grep eth0`</span></span>
* <span data-ttu-id="ee392-181">Подключитесь к серверу Linux, используя этот IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="ee392-181">Connect to your Linux server using this IP address.</span></span>

<span data-ttu-id="ee392-182">На изображении ниже показан пример подключения к серверу Node.js с помощью браузера Edge.</span><span class="sxs-lookup"><span data-stu-id="ee392-182">The picture below shows an example of this by connecting to a Node.js server using the Edge browser.</span></span>

![Доступ к сетевым приложениям Linux из Windows](media/wsl2-network-w2l.jpg)

### <a name="accessing-windows-networking-apps-from-linux-host-ip"></a><span data-ttu-id="ee392-184">Доступ к сетевым приложениям Windows из Linux (IP-адрес основной системы)</span><span class="sxs-lookup"><span data-stu-id="ee392-184">Accessing Windows networking apps from Linux (host IP)</span></span>

<span data-ttu-id="ee392-185">Если вы хотите получить доступ к сетевому приложению, работающему в Windows (например, к приложению, работающему на NodeJS или SQL Server) из дистрибутива Linux (напр., Ubuntu), необходимо использовать IP-адрес основной системы.</span><span class="sxs-lookup"><span data-stu-id="ee392-185">If you want to access a networking app running on Windows (for example an app running on a NodeJS or SQL server) from your Linux distribution (ie Ubuntu), then you need to use the IP address of your host machine.</span></span> <span data-ttu-id="ee392-186">Хотя это происходит и нечасто, для этого можно выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="ee392-186">While this is not a common scenario, you can follow these steps to make it work.</span></span>
    - <span data-ttu-id="ee392-187">Получите IP-адрес основной системы, выполнив следующую команду из дистрибутива Linux: `cat /etc/resolv.conf`</span><span class="sxs-lookup"><span data-stu-id="ee392-187">Obtain the IP address of your host machine by running this command from your Linux distribution: `cat /etc/resolv.conf`</span></span>
    - <span data-ttu-id="ee392-188">Скопируйте IP-адрес в строке, начинающейся с `nameserver`.</span><span class="sxs-lookup"><span data-stu-id="ee392-188">Copy the IP address following the term: `nameserver`.</span></span>
    - <span data-ttu-id="ee392-189">Подключитесь к любому серверу Windows, используя скопированный IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="ee392-189">Connect to any Windows server using the copied IP address.</span></span>

<span data-ttu-id="ee392-190">На изображении ниже показан пример подключения к серверу Node.js под управлением Windows через cURL.</span><span class="sxs-lookup"><span data-stu-id="ee392-190">The picture below shows an example of this by connecting to a Node.js server running in Windows via curl.</span></span>

![Доступ к сетевым приложениям Linux из Windows](media/wsl2-network-l2w.png)

### <a name="additional-networking-considerations"></a><span data-ttu-id="ee392-192">Дополнительные рекомендации по работе с сетью</span><span class="sxs-lookup"><span data-stu-id="ee392-192">Additional networking considerations</span></span>

#### <a name="connecting-via-remote-ip-addresses"></a><span data-ttu-id="ee392-193">Подключение через удаленные IP-адреса</span><span class="sxs-lookup"><span data-stu-id="ee392-193">Connecting via remote IP addresses</span></span>

<span data-ttu-id="ee392-194">При использовании удаленных IP-адресов для подключения к приложениям они будут рассматриваться как подключения из локальной сети (LAN).</span><span class="sxs-lookup"><span data-stu-id="ee392-194">When using remote IP addresses to connect to your applications, they will be treated as connections from the Local Area Network (LAN).</span></span> <span data-ttu-id="ee392-195">Это означает, что необходимо убедиться, что приложение может принимать подключения по локальной сети.</span><span class="sxs-lookup"><span data-stu-id="ee392-195">This means that you will need to make sure your application can accept LAN connections.</span></span>

<span data-ttu-id="ee392-196">Например, может потребоваться привязать приложение к `0.0.0.0` вместо `127.0.0.1`.</span><span class="sxs-lookup"><span data-stu-id="ee392-196">For example, you may need to bind your application to `0.0.0.0` instead of `127.0.0.1`.</span></span> <span data-ttu-id="ee392-197">В примере приложения Python, использующего Flask, это можно сделать с помощью команды `app.run(host='0.0.0.0')`.</span><span class="sxs-lookup"><span data-stu-id="ee392-197">In the example of a Python app using Flask, this can be done with the command: `app.run(host='0.0.0.0')`.</span></span> <span data-ttu-id="ee392-198">При внесении этих изменений не забывайте о безопасности, так как это позволит устанавливать подключения из вашей локальной сети.</span><span class="sxs-lookup"><span data-stu-id="ee392-198">Please keep security in mind when making these changes as this will allow connections from your LAN.</span></span>

#### <a name="accessing-a-wsl-2-distribution-from-your-local-area-network-lan"></a><span data-ttu-id="ee392-199">Доступ к дистрибутиву WSL 2 из локальной сети (LAN)</span><span class="sxs-lookup"><span data-stu-id="ee392-199">Accessing a WSL 2 distribution from your local area network (LAN)</span></span>

<span data-ttu-id="ee392-200">При использовании дистрибутива WSL 1, если к компьютеру можно получить доступ из локальной сети, то приложения, работающие в WSL, могут быть также доступны в локальной сети.</span><span class="sxs-lookup"><span data-stu-id="ee392-200">When using a WSL 1 distribution, if your computer was set up to be accessed by your LAN, then applications run in WSL could be accessed on your LAN as well.</span></span>

<span data-ttu-id="ee392-201">Это нетипичная ситуация в WSL 2.</span><span class="sxs-lookup"><span data-stu-id="ee392-201">This isn't the default case in WSL 2.</span></span> <span data-ttu-id="ee392-202">В WSL 2 имеется виртуализированный адаптер Ethernet с собственным уникальным IP-адресом.</span><span class="sxs-lookup"><span data-stu-id="ee392-202">WSL 2 has a virtualized ethernet adapter with its own unique IP address.</span></span> <span data-ttu-id="ee392-203">В настоящее время для включения этого рабочего процесса необходимо выполнить те же действия, что и для обычной виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="ee392-203">Currently, to enable this workflow you will need to go through the same steps as you would for a regular virtual machine.</span></span> <span data-ttu-id="ee392-204">(Мы ищем способы улучшить это взаимодействие.)</span><span class="sxs-lookup"><span data-stu-id="ee392-204">(We are looking into ways to improve this experience.)</span></span>

#### <a name="ipv6-access"></a><span data-ttu-id="ee392-205">Доступ по протоколу IPv6</span><span class="sxs-lookup"><span data-stu-id="ee392-205">IPv6 access</span></span>

<span data-ttu-id="ee392-206">В настоящее время дистрибутивы WSL 2 не могут обращаться к IPv6-адресам.</span><span class="sxs-lookup"><span data-stu-id="ee392-206">WSL 2 distributions currently cannot reach IPv6-only addresses.</span></span> <span data-ttu-id="ee392-207">Мы работаем над добавлением этой возможности.</span><span class="sxs-lookup"><span data-stu-id="ee392-207">We are working on adding this feature.</span></span>

## <a name="expanding-the-size-of-your-wsl-2-virtual-hardware-disk"></a><span data-ttu-id="ee392-208">Увеличение размера виртуального жесткого диска WSL 2</span><span class="sxs-lookup"><span data-stu-id="ee392-208">Expanding the size of your WSL 2 Virtual Hardware Disk</span></span>

<span data-ttu-id="ee392-209">WSL 2 использует виртуальный жесткий диск (VHD) для хранения файлов Linux.</span><span class="sxs-lookup"><span data-stu-id="ee392-209">WSL 2 uses a Virtual Hardware Disk (VHD) to store your Linux files.</span></span> <span data-ttu-id="ee392-210">Если использована вся доступная емкость, возможно, потребуется увеличить его размер.</span><span class="sxs-lookup"><span data-stu-id="ee392-210">If you reach its max size you may need to expand it.</span></span>

<span data-ttu-id="ee392-211">Виртуальный жесткий диск WSL 2 использует файловую систему ext4.</span><span class="sxs-lookup"><span data-stu-id="ee392-211">The WSL 2 VHD uses the ext4 file system.</span></span> <span data-ttu-id="ee392-212">Этот виртуальный жесткий диск имеет начальный максимальный размер 256 ГБ, и он автоматически изменяется по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="ee392-212">This VHD automatically resizes to meet your storage needs and has an initial maximum size of 256GB.</span></span> <span data-ttu-id="ee392-213">Если размер дистрибутива превысил 256 ГБ, вы увидите сообщение о том, что закончилось место на диске.</span><span class="sxs-lookup"><span data-stu-id="ee392-213">If your distribution grows in size to be greater than 256GB, you will see errors stating that you've run out of disk space.</span></span> <span data-ttu-id="ee392-214">Эту ошибку можно устранить, увеличив размер виртуального жесткого диска.</span><span class="sxs-lookup"><span data-stu-id="ee392-214">You can fix this error by expanding the VHD size.</span></span>

<span data-ttu-id="ee392-215">Чтобы увеличить максимальный размер виртуального жесткого диска свыше 256 ГБ:</span><span class="sxs-lookup"><span data-stu-id="ee392-215">To expand your maximum VHD size beyond 256GB:</span></span>

1. <span data-ttu-id="ee392-216">Завершите работы всех экземпляров WSL с помощью команды `wsl --shutdown`.</span><span class="sxs-lookup"><span data-stu-id="ee392-216">Terminate all WSL instances using the command: `wsl --shutdown`</span></span>

2. <span data-ttu-id="ee392-217">Найдите имя пакета установки дистрибутива ("PackageFamilyName").</span><span class="sxs-lookup"><span data-stu-id="ee392-217">Find your distribution installation package name ('PackageFamilyName')</span></span>
    * <span data-ttu-id="ee392-218">С помощью PowerShell (где "distro" — имя дистрибутива) введите команду:</span><span class="sxs-lookup"><span data-stu-id="ee392-218">Using PowerShell (where 'distro' is your distribution name) enter the command:</span></span>
    * `Get-AppxPackage -Name "*<distro>*" | Select PackageFamilyName`

3. <span data-ttu-id="ee392-219">Выберите VHD-файл `fullpath`, используемый в WSL 2. Здесь это будет `pathToVHD`:</span><span class="sxs-lookup"><span data-stu-id="ee392-219">Locate the VHD file `fullpath` used by your WSL 2 installation, this will be your `pathToVHD`:</span></span>
     * `%LOCALAPPDATA%\Packages\<PackageFamilyName>\LocalState\<disk>.vhdx`

4. <span data-ttu-id="ee392-220">Измените размер VHD WSL 2, выполнив следующие команды.</span><span class="sxs-lookup"><span data-stu-id="ee392-220">Resize your WSL 2 VHD by completing the following commands:</span></span>
   * <span data-ttu-id="ee392-221">Откройте командную строку Windows с правами администратора и введите:</span><span class="sxs-lookup"><span data-stu-id="ee392-221">Open Windows Command Prompt with admin privileges and enter:</span></span>
      * `diskpart`
      * `Select vdisk file="<pathToVHD>"`
      * `expand vdisk maximum="<sizeInMegaBytes>"`

5. <span data-ttu-id="ee392-222">Запустите дистрибутив WSL (например, Ubuntu).</span><span class="sxs-lookup"><span data-stu-id="ee392-222">Launch your WSL distribution (Ubuntu, for example).</span></span>

6. <span data-ttu-id="ee392-223">Сделайте, чтобы WSL мог увеличить размер файловой системы, выполнив следующие команды в командной строке дистрибутива Linux:</span><span class="sxs-lookup"><span data-stu-id="ee392-223">Make WSL aware that it can expand its file system's size by running these commands from your Linux distribution command line:</span></span>
    * `sudo mount -t devtmpfs none /dev`
    * `mount | grep ext4`
    * <span data-ttu-id="ee392-224">Скопируйте имя этой записи, которая будет выглядеть следующим образом: `/dev/sdXX` (вместо X может быть любой другой символ).</span><span class="sxs-lookup"><span data-stu-id="ee392-224">Copy the name of this entry, which will look like: `/dev/sdXX` (with the X representing any other character)</span></span>
    * `sudo resize2fs /dev/sdXX`
    * <span data-ttu-id="ee392-225">Используйте скопированное ранее значение.</span><span class="sxs-lookup"><span data-stu-id="ee392-225">Use the value you copied earlier.</span></span> <span data-ttu-id="ee392-226">Также может потребоваться установить приложение resize2fs: `apt install resize2fs`</span><span class="sxs-lookup"><span data-stu-id="ee392-226">You may also need to install resize2fs: `apt install resize2fs`</span></span>

> [!NOTE]
> <span data-ttu-id="ee392-227">Как правило, не следует изменять, перемещать файлы, связанные с WSL, расположенным внутри папки AppData, или получать к ним доступ с помощью инструментов или редакторов Windows.</span><span class="sxs-lookup"><span data-stu-id="ee392-227">In general do not modify, move, or access the WSL related files located inside of your AppData folder using Windows tools or editors.</span></span> <span data-ttu-id="ee392-228">Это может привести к повреждению дистрибутива Linux.</span><span class="sxs-lookup"><span data-stu-id="ee392-228">Doing so could cause your Linux distribution to become corrupted.</span></span>
